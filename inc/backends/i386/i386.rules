

// #define RULE(pattern, action)

RULE(Nodes.Seq(0, 0), {
    MUNCH(root->kids[0]);
    MUNCH(root->kids[1]);
})

RULE(Nodes.Mov(Nodes.Tmp(), 0), {
    Opr *dst = MUNCH(root->kids[0]);
    Opr *src = MUNCH(root->kids[1]);
    EMIT(Mov(dst, src));
})

RULE(Nodes.Tmp(), {
    return OPR({
        .index = root->index
    });
})

RULE(Nodes.Add(0, 0), {
    Opr *left = MUNCH(root->kids[0]);
    Opr *right = MUNCH(root->kids[1]);
    EMIT(Add(left, right));
    return left;
})

RULE(Nodes.I32(0), {
    return OPR({
        .i32 = root->i32
    });
})
